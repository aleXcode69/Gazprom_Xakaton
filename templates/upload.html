<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö CSV | –ì–∞–∑–ø—Ä–æ–º</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="upload-container">
        <div class="upload-card">
            <div class="logo-container">
                <img src="/static/ALLlogo.svg" alt="–ì–∞–∑–ø—Ä–æ–º" class="gazprom-logo">
            </div>
            
            <div class="upload-header">
                <h1><span class="highlight">–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä</span> CSV-–¥–∞–Ω–Ω—ã—Ö</h1>
                <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
            </div>
            
            <form action="/analyze" method="post" enctype="multipart/form-data" class="upload-form">
                <div class="file-upload-wrapper" id="drop-zone">
                    <label for="file" class="file-upload-label">
                        <svg class="upload-icon" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        <span class="file-upload-text">–í—ã–±–µ—Ä–∏—Ç–µ CSV —Ñ–∞–π–ª</span>
                        <span class="file-upload-hint">–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –µ–≥–æ —Å—é–¥–∞</span>
                    </label>
                    <input type="file" name="file" id="file" accept=".csv" required class="file-input">
                    
                    <div class="file-selected" id="file-selected">
                        <span class="file-name" id="file-name">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</span>
                        <button type="button" class="clear-file" id="clear-file">√ó</button>
                    </div>
                </div>
                
                <div class="error-message" id="error-message"></div>
                
                <div class="form-footer">
                    <button type="submit" class="upload-button">
                        <span class="button-text">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</span>
                        <span class="button-icon">‚Üí</span>
                    </button>
                </div>
            </form>
            
            <div class="upload-features">
                <div class="feature">
                    <div class="feature-icon">üìä</div>
                    <p>–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üîç</div>
                    <p>–í—ã—è–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">üìà</div>
                    <p>–í–∏–∑—É–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fileInput = document.getElementById('file');
        const fileName = document.getElementById('file-name');
        const fileSelected = document.getElementById('file-selected');
        const clearFile = document.getElementById('clear-file');
        const dropZone = document.getElementById('drop-zone');
        const errorMessage = document.getElementById('error-message');
        const form = document.querySelector('.upload-form');

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                fileName.textContent = e.target.files[0].name;
                fileSelected.style.display = 'flex';
                errorMessage.style.display = 'none';
            }
        });

        clearFile.addEventListener('click', () => {
            fileInput.value = '';
            fileName.textContent = '–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω';
            fileSelected.style.display = 'none';
        });

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropZone.classList.add('drag-over');
        }

        function unhighlight() {
            dropZone.classList.remove('drag-over');
        }

        dropZone.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length) {
                const file = files[0];
                if (file.name.endsWith('.csv') || file.type === 'text/csv') {
                    fileInput.files = files;
                    fileName.textContent = file.name;
                    fileSelected.style.display = 'flex';
                    errorMessage.style.display = 'none';
                } else {
                    showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV');
                }
            }
        }

        form.addEventListener('submit', function(e) {
            if (!fileInput.files.length) {
                e.preventDefault();
                showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –ø–µ—Ä–µ–¥ –∞–Ω–∞–ª–∏–∑–æ–º');
            }
        });

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>
